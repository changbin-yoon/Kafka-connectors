---
# Rook-Ceph RGW NodePort 서비스
# 물리적으로 분리된 클러스터에서 Ceph RGW에 접근하기 위한 NodePort 서비스
# 
# 사용 방법:
# 1. Ceph 클러스터에서 이 파일을 적용:
#    kubectl apply -f rook-ceph-rgw-nodeport.yaml -n rook-ceph
#
# 2. NodePort 확인:
#    kubectl get svc rook-ceph-rgw-nodeport -n rook-ceph
#
# 3. 외부 클러스터에서 접근:
#    <NODE_IP>:<NODE_PORT> 형식으로 접근 (예: 192.168.1.100:30080)

apiVersion: v1
kind: Service
metadata:
  name: rook-ceph-rgw-nodeport
  namespace: rook-ceph
  labels:
    app: rook-ceph-rgw
    service-type: external
spec:
  type: NodePort
  selector:
    app: rook-ceph-rgw
    # Rook-Ceph RGW 파드의 실제 label로 변경해야 할 수 있습니다
    # kubectl get pods -n rook-ceph -l app=rook-ceph-rgw --show-labels 로 확인
  ports:
    - name: http
      port: 80
      targetPort: 80
      protocol: TCP
      # NodePort를 지정하지 않으면 Kubernetes가 자동으로 할당합니다 (30000-32767 범위)
      # 특정 포트를 원하면 아래 주석을 해제하고 원하는 포트를 입력하세요
      # nodePort: 30080
  sessionAffinity: ClientIP

